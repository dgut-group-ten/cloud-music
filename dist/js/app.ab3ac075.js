(function(t){function e(e){for(var n,r,i=e[0],l=e[1],c=e[2],m=0,d=[];m<i.length;m++)r=i[m],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},s={app:0},o=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"17ee":function(t,e,a){"use strict";var n=a("8af5"),s=a.n(n);s.a},2395:function(t,e,a){},4319:function(t,e,a){},"559f":function(t,e,a){"use strict";var n=a("f5df"),s=a.n(n);s.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view"),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.isScrollTop,expression:"isScrollTop"}],staticClass:"back-to-top",attrs:{icon:"el-icon-arrow-up",circle:""},on:{click:t.scrollToTop}})],1)},o=[],r=(a("4795"),{created:function(){var t=this;localStorage.getItem("state")&&this.$store.replaceState(JSON.parse(localStorage.getItem("state"))),window.addEventListener("beforeunload",(function(){localStorage.setItem("state",JSON.stringify(t.$store.state)),window.localStorage.removeItem("hasPlayerPage"),window.localStorage.removeItem("playlist")}))},mounted:function(){var t=this;window.addEventListener("scroll",(function(){t.scrollTop=document.documentElement.scrollTop||document.body.scrollTop,t.scrollTop>150?t.isScrollTop=!0:t.isScrollTop=!1}),!0)},data:function(){return{isScrollTop:!1}},methods:{scrollToTop:function(){var t=this;setTimeout((function e(){t.scrollTop>0&&setTimeout((function(){var a=8*t.scrollTop/100;t.scrollTop-=a,document.documentElement.scrollTop>0?document.documentElement.scrollTop=t.scrollTop-a:document.body.scrollTop>0&&(document.body.scrollTop=t.scrollTop-a),e()}),1)}),1)}}}),i=r,l=(a("7c55"),a("2877")),c=Object(l["a"])(i,s,o,!1,null,null,null),u=c.exports,m=a("8c4f"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("Head",{on:{loginHandle:t.loginHandle}}),a("router-view"),a("Foot"),a("el-dialog",{attrs:{visible:t.dialogVisible,width:"35%",title:t.title},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-tabs",{attrs:{type:"card",stretch:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[a("el-tab-pane",{attrs:{label:"登录",name:"first"}},[a("Login",{on:{hideDialog:t.hideDialog}})],1),a("el-tab-pane",{attrs:{label:"注册",name:"second"}},[a("Register",{on:{registered:t.registered}})],1)],1)],1)],1)},p=[],f=(a("b0c0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-menu",{attrs:{"default-active":t.activeIndex,"background-color":"#545c64",mode:"horizontal","text-color":"#fff","active-text-color":"#c40b0b"}},[a("el-menu-item",{attrs:{index:"1"}},[a("router-link",{attrs:{to:"/home"}},[t._v("首页")])],1),a("el-menu-item",{attrs:{index:"2"}},[a("router-link",{attrs:{to:"/home"}},[t._v("我的音乐")])],1),a("el-menu-item",{attrs:{index:"3"}},[a("router-link",{attrs:{to:"/home"}},[t._v("MV")])],1),a("el-menu-item",{attrs:{index:"4"}},[a("router-link",{attrs:{to:"/home"}},[t._v("电台")])],1),a("el-menu-item",{attrs:{index:"5"}},[a("router-link",{attrs:{to:"/home"}},[t._v("歌手")])],1),t.isLogin?t._e():a("el-menu-item",{staticClass:"fr",attrs:{index:"6"},on:{click:t._loginHandle}},[t._v("登录")]),t.isLogin?a("el-submenu",{staticClass:"fr",attrs:{index:"7"}},[a("template",{slot:"title"},[t._v(t._s(t.userInfo.name))]),a("el-menu-item",{attrs:{index:"7-1"},on:{click:t._logout}},[t._v("退出登录")])],2):t._e(),a("el-menu-item",{staticClass:"fr",attrs:{index:"8"}},[a("el-input",{attrs:{placeholder:"搜索音乐、歌单、用户"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}},[a("i",{staticClass:"el-icon-search",attrs:{slot:"suffix"},on:{click:t.search},slot:"suffix"})])],1)],1)}),h=[],g=(a("7ce2"),{name:"Head",data:function(){return{activeIndex:"1",userInfo:null,searchText:""}},methods:{_loginHandle:function(){this.$emit("loginHandle")},_logout:function(){this.$store.dispatch("logout")},search:function(){var t=this.searchText;null!=t&&(this.searchText=null,this.$router.push({name:"search",query:{searchText:t}}))}},created:function(){var t=JSON.parse(localStorage.getItem("state")||null);t&&(this.userInfo=t.userInfo)},computed:{isLogin:{get:function(){return null!=this.$store.state.userInfo},set:function(t){}}},watch:{isLogin:function(t,e){if(!0===t){var a=JSON.parse(localStorage.getItem("state")||null);a&&(this.userInfo=a.userInfo)}}}}),v=g,y=(a("aff6"),Object(l["a"])(v,f,h,!1,null,"0ada48a6",null)),b=y.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{model:t.registerInfo}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名",autofocus:""},model:{value:t.registerInfo.name,callback:function(e){t.$set(t.registerInfo,"name",e)},expression:"registerInfo.name"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"密码",type:"password"},model:{value:t.registerInfo.password,callback:function(e){t.$set(t.registerInfo,"password",e)},expression:"registerInfo.password"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"邮箱"},model:{value:t.registerInfo.email,callback:function(e){t.$set(t.registerInfo,"email",e)},expression:"registerInfo.email"}})],1),a("el-form-item",{staticClass:"code"},[a("el-input",{attrs:{placeholder:"验证码"},model:{value:t.registerInfo.checkCode,callback:function(e){t.$set(t.registerInfo,"checkCode",t._n(e))},expression:"registerInfo.checkCode"}}),a("el-button",{attrs:{disabled:t.disabled},on:{click:t._checkCode}},[t._v(t._s(t.tip))])],1),a("el-form-item",{staticClass:"register"},[a("el-button",{attrs:{type:"primary"},on:{click:t._register}},[t._v("注册")])],1)],1)},x=[],C=(a("d3b7"),a("bc3a")),w=a.n(C),T=w.a.create({timeout:1e4});T.interceptors.request.use((function(t){t.transformRequest=[function(t){var e="";for(var a in t)e+=encodeURIComponent(a)+"="+encodeURIComponent(t[a])+"&";return e.substr(0,e.length-1)}];var e=JSON.parse(window.localStorage.getItem("state")).userInfo;return e&&(t.headers["Token"]=e.Token),t}),(function(t){return Promise.reject(t)})),T.interceptors.response.use((function(t){var e=t.status/100|0;return 2!==e?Promise.reject({status:t.status,message:res.message}):t.data}),(function(t){if(t&&t.response)switch(t.response.status){case 400:t.message="错误请求";break;case 401:t.message="未授权，请重新登录";break;case 403:t.message="拒绝访问";break;case 404:t.message="请求错误,未找到该资源";break;case 405:t.message="请求方法未允许";break;case 408:t.message="请求超时";break;case 500:t.message="服务器端出错";break;case 501:t.message="网络未实现";break;case 502:t.message="网络错误";break;case 503:t.message="服务不可用";break;case 504:t.message="网络超时";break;case 505:t.message="http版本不支持该请求";break;default:t.message="未知错误".concat(t.response.status)}else t.message="连接到服务器失败";return Promise.reject(t)}));var k=T,I=(a("99af"),"dev"),S={prod:"music",dev:"music-01",python:"8002",java:"8001"},O=function(t){return"https://".concat(S[I],".niracler.com:").concat(S[t])},L=O("java"),$=function(t){var e=t.checkCode,a=t.email,n=t.name,s=t.password;return k({url:"".concat(L,"/user"),method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:{checkCode:e,email:a,name:n,password:s}})},P=function(t){var e="".concat(L,"/email");return k({url:e,method:"post",data:{to:t}})},N=function(t){var e=t.name,a=t.password;return k({url:"".concat(L,"/user/token"),method:"post",data:{name:e,password:a}})},j={name:"register",data:function(){return{labelPosition:"right",registerInfo:{email:"",name:"",password:"",checkCode:null},send:0,tip:"发送",disabled:!1}},methods:{_checkCode:function(){var t=this;this.send=1,this.disabled=!0;var e=60,a=setInterval((function(){e--,t.tip=e,0===e&&(clearInterval(a),t.tip="发送",t.send=0,t.disabled=!1)}),1e3);P(this.registerInfo.email).then((function(e){t.$message({message:e.message,type:"success"})}))["catch"]((function(e){var a=e.response.data.msg||e.message;t.$message.error(a)}))},_register:function(){var t=this;$(this.registerInfo).then((function(e){t.$message({message:e.message,type:"success"}),t._initRegisterInfo(),t.$emit("registered")}))["catch"]((function(e){var a=e.response.data.msg||e.message;t.$message.error(a)}))},_initRegisterInfo:function(){this.registerInfo={email:"",name:"",password:"",checkCode:null}}}},E=j,M=(a("eabe"),Object(l["a"])(E,_,x,!1,null,"41266a4a",null)),q=M.exports,H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{model:t.userInfo}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"用户名"},model:{value:t.userInfo.name,callback:function(e){t.$set(t.userInfo,"name",e)},expression:"userInfo.name"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"密码","show-password":""},model:{value:t.userInfo.password,callback:function(e){t.$set(t.userInfo,"password",e)},expression:"userInfo.password"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t._login}},[t._v("登录")])],1)],1)},J=[],R={name:"Login",data:function(){return{labelPosition:"right",userInfo:{name:"",password:""}}},methods:{_login:function(){var t=this;N(this.userInfo).then((function(e){t.$message({message:e.message,type:"success"}),t.$emit("hideDialog"),t.$store.dispatch("logined",e.data)}))["catch"]((function(e){var a=e.response.data.msg||e.message;t.$message.error(a)}))}}},D=R,F=(a("e394"),Object(l["a"])(D,H,J,!1,null,"410bf9fe",null)),G=F.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",[t._v(" Copyright © 2019 DGUT Group Ten. All Rights Reserved. ")])},V=[],U={name:"Foot"},z=U,A=(a("7eec"),Object(l["a"])(z,B,V,!1,null,"7e44a78b",null)),K=A.exports,Q={name:"home",components:{Head:b,Register:q,Login:G,Foot:K},data:function(){return{dialogVisible:!1,name:"first"}},computed:{title:function(){return"first"===this.name?"用户名登录":"邮箱注册"}},methods:{loginHandle:function(){this.dialogVisible=!0,document.querySelector(".el-dialog").classList.add("side-in")},hideDialog:function(){this.dialogVisible=!1,document.querySelector(".el-dialog").classList.remove("side-in")},registered:function(){this.name="first"}}},W=Q,X=(a("de16"),Object(l["a"])(W,d,p,!1,null,null,null)),Y=X.exports,Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.songInfo?a("div",{staticClass:"player"},[a("audio",{staticStyle:{display:"none"},attrs:{id:"audio",controls:"controls",autoplay:"autoplay",src:t.songInfo.file}}),a("div",{staticClass:"player-main"},[a("div",{staticClass:"back",on:{click:t.back}},[t._v("QO音乐")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.percentage,expression:"!percentage"}],staticClass:"player-panel"},[a("img",{staticClass:"song-avatar",attrs:{src:t.songInfo.cimg,alt:""}}),a("div",{staticClass:"song-info"},[a("div",{staticClass:"song-name",attrs:{title:t.songInfo.name}},[t._v(t._s(t.songInfo.name))]),a("div",{staticClass:"song-author"},[t._v(t._s(t.songInfo.authors[0].name))])]),a("div",{staticClass:"song-progress"},[a("span",[t._v(t._s(t.timeFormat(t.currentTime)))]),t.percentage?a("el-progress",{attrs:{percentage:t.percentage,color:"#909399","show-text":!1,"stroke-width":1}}):t._e(),a("span",[t._v(t._s(t.timeFormat(t.duration)))])],1),a("div",{staticClass:"song-control"},[a("a",{staticClass:"song-control_item",attrs:{href:"javascript:;",title:"暂停"},on:{click:t.contorlPlay}},[a("i",{staticClass:"icon-pause"})]),a("a",{staticClass:"song-control_item",attrs:{href:"javascript:;",title:"下一首"},on:{click:t.playNext}},[a("i",{staticClass:"icon-next"})]),a("a",{staticClass:"song-control_item",attrs:{href:"javascript:;",title:"关闭声音"},on:{click:t.contorlVolume}},[a("i",{staticClass:"icon-volume"})]),a("div",{staticClass:"volume"},[a("el-slider",{attrs:{"show-tooltip":!1,min:0,max:1,step:.001},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),t._m(0)])]),a("ul",{staticClass:"lyric"})]),a("div",{staticClass:"player-bg_mask"}),a("div",{staticClass:"player-bg",style:{backgroundImage:"url("+t.songInfo.cimg+")"}})]):t._e()},tt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"right-part"},[a("a",{staticClass:"song-control_item",attrs:{href:"javascript:;",title:"喜欢"}},[a("i",{staticClass:"icon-like"})]),a("a",{staticClass:"song-control_item",attrs:{href:"javascript:;",title:"删除"}},[a("i",{staticClass:"icon-delete"})]),a("a",{staticClass:"song-control_item",attrs:{href:"javascript:;",title:"更多"}},[a("i",{staticClass:"icon-more"})])])}],et=(a("4160"),a("ac1f"),a("5319"),a("159b"),O("python")),at=function(t){return k({url:"".concat(et,"/playlist/?tags=").concat(t,"&ps=8"),method:"get"})},nt=function(t){return k({url:"".concat(et,"/playlist/").concat(t),method:"get"})},st=function(t){return k({url:"".concat(et,"/song/").concat(t),method:"get"})},ot=(a("3e8f"),{name:"Player",data:function(){return{songInfo:null,currentTime:null,duration:null,percentage:0,volume:.3,volumeCopy:.3,ismuted:!1,lineNo:0}},created:function(){var t=this,e=t.$route.query.sid;st(e).then((function(e){t.loadMusic(e)})),window.addEventListener("storage",(function(e){var a=e.key;if("playlist"===a){var n=JSON.parse(e.newValue),s=n.shift();st(s).then((function(e){t.loadMusic(e),window.localStorage.setItem("playlist",JSON.stringify(n))}))}})),window.onbeforeunload=function(){this.clear()}},methods:{back:function(){this.clear(),this.$router.push({name:"main"})},clear:function(){window.localStorage.removeItem("hasPlayerPage"),window.localStorage.removeItem("playlist")},loadMusic:function(t){var e=this;e.songInfo=t,console.log("res",t),setTimeout((function(){var a=document.querySelector("#audio");a.src=t.file,a.oncanplay=function(){e.duration=a.duration},e.lineNo=0,document.querySelector(".lyric").scrollTop=0,a.addEventListener("timeupdate",(function(){e.currentTime=a.currentTime,e.percentage=a.currentTime/a.duration*100,e.currentTime===e.duration&&e.playNext();var t=e.songInfo.lyric;0!==t.length&&(e.lineNo===t.length-1&&a.currentTime>=t[e.lineNo].time&&e.highlight(e.lineNo),t[e.lineNo].time<=a.currentTime&&a.currentTime<=t[e.lineNo+1].time&&(e.highlight(e.lineNo),e.lineNo++))})),a.volume=.3;var n=document.querySelector(".lyric");n.innerHTML="",e.createLrc(t.lyric)}),20)},contorlPlay:function(t){var e=document.querySelector("#audio");e.paused?(e.play(),t.currentTarget.children[0].classList.replace("icon-play","icon-pause"),t.currentTarget.title="暂停"):(e.pause(),t.currentTarget.children[0].classList.replace("icon-pause","icon-play"),t.currentTarget.title="播放")},contorlVolume:function(t){var e=document.querySelector("#audio");this.ismuted?(this.ismuted=!1,e.muted=!1,t.currentTarget.children[0].classList.replace("icon-mute","icon-volume"),t.currentTarget.title="关闭声音"):(this.ismuted=!0,e.muted=!0,t.currentTarget.children[0].classList.replace("icon-volume","icon-mute"),t.currentTarget.title="打开声音")},playNext:function(){var t=this,e=JSON.parse(window.localStorage.getItem("playlist"));if(e){var a=e.shift();st(a).then((function(a){t.loadMusic(a),window.localStorage.setItem("playlist",JSON.stringify(e))}))}else this.$message("没有下一首啦，去添加新的歌曲吧！")},timeFormat:function(t){var e=t/60|0,a=t-60*e|0;return e<10&&(e="0"+e),a<10&&(a="0"+a),"".concat(e,":").concat(a)},createLrc:function(t){var e=document.querySelector(".lyric"),a=null;if(0===t.length)return a=document.createElement("li"),a.innerHTML="该歌曲为纯音乐，木有歌词",void e.appendChild(a);t.forEach((function(t){a=document.createElement("li"),a.innerHTML=t.text,e.appendChild(a)}))},highlight:function(t){var e=document.querySelector(".lyric");t>0&&(e.children[t-1].style.color="#e9e4e9");var a=e.children[t];a.style.color="#c40b0b",a.offsetTop-e.scrollTop>544&&(e.scrollTop+=168)}},watch:{volume:function(t,e){var a=document.querySelector("#audio");a.volume=t}}}),rt=ot,it=(a("ab61"),Object(l["a"])(rt,Z,tt,!1,null,"3a26220e",null)),lt=it.exports,ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("gallery",{attrs:{info:t.config.playlistRecommended}}),a("gallery",{attrs:{info:t.config.playlistRecommended}})],1)},ut=[],mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"gallery-wrapper"},[a("header",{staticClass:"gallery-header"},[t._v(t._s(t.info.name))]),a("ul",{staticClass:"gallery-nav"},t._l(t.info.tags,(function(e,n){return a("li",{key:n,staticClass:"gallery-nav__item",style:{color:t.curIndex===n?"#c40b0b":""},on:{click:function(e){return t.clickHandle(n)}}},[t._v(" "+t._s(e)+" ")])})),0),a("section",{staticClass:"gallery-main"},[a("el-carousel",{ref:"carousel",attrs:{type:"card",height:"300px",autoplay:!1,trigger:"click"},nativeOn:{click:function(e){return t._toDetailPage(e)}}},t._l(t.playlist,(function(e,n){return a("el-carousel-item",{key:n},[a("img",{staticClass:"gallery-main__img",attrs:{src:e.cimg}}),a("div",{staticClass:"gallery-main__text"},[t._v(t._s(e.name))])])})),1)],1)])},dt=[],pt={name:"Gallery",props:["info"],data:function(){return{curIndex:0,playlist:[]}},created:function(){this._getPlaylist()},watch:{curIndex:function(){this._getPlaylist()}},methods:{clickHandle:function(t){this.curIndex=t},_getPlaylist:function(){var t=this,e=this.info.tags[this.curIndex];at(e).then((function(e){t.playlist=e.results}))},_toDetailPage:function(t){if("gallery-main__img"===t.target._prevClass){var e=this.playlist[this.$refs.carousel.activeIndex].lid;this.$router.push({name:"detail",query:{lid:e}})}}}},ft=pt,ht=(a("f81a"),Object(l["a"])(ft,mt,dt,!1,null,"fb7ac1ce",null)),gt=ht.exports,vt={playlistRecommended:{name:"歌单推荐",tags:["日语","ACG","治愈","轻音乐","流行"]}},yt={name:"Main",data:function(){return{config:vt}},components:{Gallery:gt}},bt=yt,_t=Object(l["a"])(bt,ct,ut,!1,null,"d17a2616",null),xt=_t.exports,Ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.playlist?a("div",{staticClass:"main"},[a("div",{staticClass:"data"},[a("Breadcrumb"),a("div",{staticClass:"data-cover"},[a("img",{staticClass:"data-photo",attrs:{src:t.playlist.cimg}})]),a("div",{staticClass:"data-cont"},[a("div",{staticClass:"data-name"},[t._v(" "+t._s(t.playlist.name)+" ")]),a("div",{staticClass:"data-singer"},[a("i",{staticClass:"el-icon-user"}),t._v(" "+t._s(t.playlist.creator)+" ")]),a("div",[a("span",[t._v("标签：")]),t._l(t.playlist.tags,(function(e,n){return a("ul",{key:n,staticClass:"data-tags"},[a("li",{staticClass:"data-tag"},[t._v(t._s(e))])])}))],2),a("div",[t._v(" 播放量："+t._s(t.playlist.click)+" ")]),a("el-row",[a("el-button",{attrs:{type:"primary",icon:"el-icon-video-play"},on:{click:t.playAll}},[t._v("播放全部")]),a("el-button",{attrs:{icon:"el-icon-star-off"}},[t._v("收藏")]),a("el-button",{attrs:{icon:"el-icon-chat-dot-square"},on:{click:t.goToComment}},[t._v("评论 ("+t._s(t.commentNum)+")")]),a("el-button",{attrs:{icon:"el-icon-more-outline"}},[t._v("更多")])],1)],1)],1),a("el-row",{staticClass:"detail",attrs:{gutter:40}},[a("el-col",{attrs:{span:18}},[a("Table",{attrs:{curList:t.curList,playlist:t.playlist,total:t.total,title:["歌曲","歌手","操作"],prop:"authors[0].name",width:300}})],1),a("el-col",{staticClass:"desc",attrs:{span:6}},[a("h3",{staticClass:"desc-title"},[t._v("简介")]),a("div",{staticClass:"desc-cont"},[t._v(" "+t._s(t.playlist.description)+" ")])])],1),a("comment",{staticClass:"comment",attrs:{id:"comment",rid:t.playlist.lid}})],1):t._e()},wt=[],Tt=(a("fb6a"),O("java")),kt=function(t,e,a){return k({url:"".concat(Tt,"/comment?rid=").concat(t,"&type=1&p=").concat(e,"&ps=").concat(a),method:"get"})},It=function(t,e){return k({url:"".concat(Tt,"/comment"),method:"post",data:{content:t,type:1,resourceId:e}})},St=function(t,e,a){return k({url:"".concat(Tt,"/comment"),method:"post",data:{content:t,type:1,resourceId:e,repliedCommentId:a}})},Ot=function(t,e,a){return k({url:"".concat(Tt,"/comment/").concat(t,"?offset=").concat(e,"&size=").concat(a),method:"get"})},Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.comments?a("div",{staticClass:"comment"},[a("h1",[t._v("评论")]),a("span",[t._v("共"+t._s(t.comments.totalElements)+"条评论")]),a("div",{staticClass:"comment-edit"},[a("el-input",{attrs:{type:"textarea",placeholder:"期待你的精彩故事",maxlength:"300","show-word-limit":"",autosize:{minRows:4,maxRows:6}},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),a("el-button",{staticClass:"comment-submit",attrs:{size:"small",type:"primary"},on:{click:t.commentMainFloor}},[t._v("发表评论")])],1),a("div",{staticClass:"comment-show"},[a("h2",[t._v("最新评论")]),a("span",[t._v("("+t._s(t.comments.totalElements)+")")]),a("ul",{staticClass:"comment-list"},t._l(t.curList,(function(e,n){return a("li",{key:n,staticClass:"comment-item"},[a("img",{staticClass:"avatar",attrs:{src:"https://gss3.bdstatic.com/7Po3dSag_xI4khGkpoWK1HF6hhy/baike/s%3D220/sign=5f4834870d3b5bb5bad727fc06d2d523/2e2eb9389b504fc2a21e8529ebdde71190ef6d5c.jpg"}}),a("div",{staticClass:"comment-desc"},[a("div",{staticClass:"comment-operator"},[a("div",{staticClass:"like active"},[a("i",{staticClass:"el-icon-thumb"}),a("span",[t._v(t._s(e.likedCount))])]),a("span",{staticClass:"active",on:{click:function(a){return t.showSubfloorBlock(a,e)}}},[t._v("回复("+t._s(e.totalCountOfSonComment)+")")])]),a("div",{staticClass:"comment-desc__name"},[t._v(t._s(e.user.name))]),a("div",{staticClass:"comment-desc__cont"},[t._v(t._s(e.content))]),a("div",{staticClass:"comment-desc__time"},[t._v(t._s(t.timeFormat(e.created)))])]),a("div",{staticClass:"sub-comment-block",staticStyle:{display:"none"}},[a("el-button",{staticClass:"sub-comment-block_submit",attrs:{size:"mini"},on:{click:function(e){return t.commentSubFloor(n)}}},[t._v("发表")]),a("el-input",{staticClass:"sub-comment-block_edit",attrs:{type:"textarea",placeholder:"哥们，来个神回复",maxlength:"300","show-word-limit":"",autosize:{minRows:2,maxRows:6}},model:{value:t.subTextarea,callback:function(e){t.subTextarea=e},expression:"subTextarea"}}),0!==e.commentList.length?a("ul",{staticClass:"sub-comments"},t._l(e.commentList,(function(n,s){return a("li",{key:s,staticClass:"sub-comment"},[a("span",{staticClass:"left"},[a("span",{staticClass:"sub-comment_name"},[t._v(t._s(n.user.name))]),n.repliedUser.uid!==e.user.uid?a("span",[t._v("回复")]):t._e(),n.repliedUser.uid!==e.user.uid?a("span",{staticClass:"sub-comment_replied"},[t._v(t._s(n.repliedUser.name))]):t._e(),a("span",[t._v(":")]),a("span",{staticClass:"sub-comment_content"},[t._v(t._s(n.content))])]),a("span",{staticClass:"sub-comment_reply_btn",on:{click:function(e){return t.deepComment(n)}}},[t._v("回复")]),a("span",{staticClass:"sub-comment_time"},[t._v(t._s(t.timeFormat(n.created)))])])})),0):t._e(),a("div",{staticClass:"btn-wrapper"},[e.totalCountOfSonComment>e.commentList.length?a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.loadSonComments(e)}}},[t._v(" 加载更多")]):t._e()],1)],1)])})),0),a("div",{staticClass:"load-more"},[t.isHasMore?a("el-button",{attrs:{type:"text"},on:{click:t.loadMore}},[t._v("加载更多")]):a("el-button",{attrs:{type:"text"}},[t._v("别点了，真的一滴都没有了")])],1)])]):t._e()},$t=[],Pt=(a("caad"),a("c975"),a("2532"),a("284c")),Nt=(a("0d03"),a("e25e"),function(t){var e=t.indexOf("T"),a=t.indexOf("."),n=t.substr(0,e),s=t.substr(e+1,a-e-1),o=n+" "+s;r=new Date(Date.parse(o)),r=r.getTime(),r/=1e3;var r=r+28800,i=new Date(1e3*parseInt(r)).toLocaleString("chinese",{hour12:!1});return i}),jt={name:"comment",data:function(){return{textarea:null,comments:null,curPage:1,curList:[],isHasMore:!0,subTextarea:null,pastTarget:null,pastTextEl:null,pastItem:null,deepCommentId:null}},props:["rid"],created:function(){this.loadComments()},methods:{timeFormat:function(t){return Nt(t)},loadMore:function(){var t=this;this.curPage++,kt(this.rid,this.curPage,5).then((function(e){var a;0!==e.data.content.length&&(a=t.curList).push.apply(a,Object(Pt["a"])(e.data.content));t.curList.length===t.comments.totalElements&&(t.isHasMore=!1)}))},loadComments:function(){var t=this;kt(this.rid,this.curPage,5).then((function(e){t.comments=e.data,t.curList=t.comments.content}))},loadSonComments:function(t){Ot(t.cid,t.commentList.length,3).then((function(e){var a;(a=t.commentList).push.apply(a,Object(Pt["a"])(e.data))}))},commentMainFloor:function(){var t=this;this.textarea||this.$message("别闹！你什么都没写好么！"),It(this.textarea,this.rid).then((function(e){t.$message({message:"上传成功。整个世界将传扬你的惊世之作！",type:"success"}),t.textarea=null,t.loadComments()}))},commentSubFloor:function(t){var e,a,n=this;if(this.subTextarea){if(this.deepCommentId&&"@"===this.subTextarea[0]&&this.subTextarea.includes(":")){e=this.deepCommentId;var s=this.subTextarea.indexOf(":");if(a=this.subTextarea.slice(s+1,this.subTextarea.length),!a)return void this.$message("别闹！你什么都没写好么！")}else e=this.curList[t].cid,a=this.subTextarea,this.deepCommentId=null;console.log(e),St(a,this.rid,e).then((function(t){n.$message({message:"上传成功。整个世界将传扬你的惊世之作！",type:"success"}),n.subTextarea=null,n.loadComments(),e===n.pastItem.cid&&n.pastItem.totalCountOfSonComment++,n.deepCommentId=null}))}else this.$message("别闹！你什么都没写好么！")},deepComment:function(t){this.subTextarea="@".concat(t.user.name,":"),this.deepCommentId=t.cid},showSubfloorBlock:function(t,e){var a=t.currentTarget.parentNode.parentNode.parentNode.children[2];this.isExpand(t,e)?a.style.display="none":(null!==this.pastTarget&&this.pastTarget!==a&&(this.pastText.innerHTML="回复(".concat(this.pastItem.totalCountOfSonComment,")"),this.pastTarget.style.display="none"),this.pastTarget=a,this.pastText=t.currentTarget,this.pastItem=e,this.subTextarea=null,a.style.display="block")},isExpand:function(t,e){return"回"===t.currentTarget.innerHTML[0]?(t.currentTarget.innerHTML="收起回复",!1):(t.currentTarget.innerHTML="回复(".concat(e.totalCountOfSonComment,")"),!0)}}},Et=jt,Mt=(a("559f"),Object(l["a"])(Et,Lt,$t,!1,null,"1473c416",null)),qt=Mt.exports,Ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-breadcrumb",{attrs:{separator:"/"}},[t._l(t.path.slice(0,t.len-1),(function(e,n){return a("el-breadcrumb-item",{key:n,attrs:{to:{path:e}}},[t._v(t._s(t.nameMapping(e)))])})),a("el-breadcrumb-item",[t._v(t._s(t.nameMapping(t.path[t.len-1])))])],2)},Jt=[],Rt=(a("1276"),{name:"Breadcrumb",created:function(){for(var t=window.location.hash,e=t.slice(1,t.indexOf("?")).split("/"),a=[],n="",s=1;s<e.length;s++)n+="/"+e[s],a.push(n);this.path=a,this.len=a.length},data:function(){return{path:[],len:null}},methods:{nameMapping:function(t){switch(t){case"/home":return"首页";case"/home/detail":return"歌单详情"}}}}),Dt=Rt,Ft=(a("c453"),Object(l["a"])(Dt,Ht,Jt,!1,null,"b6099902",null)),Gt=Ft.exports,Bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{data:t.list,stripe:""},on:{"cell-mouse-enter":t.showBtnGroup,"cell-mouse-leave":t.hideBtnGroup}},[a("el-table-column",{attrs:{type:"index",index:t.indexMethod,width:"80"}}),a("el-table-column",{attrs:{prop:"name",label:t.title[0],width:t.width}}),a("el-table-column",{attrs:{prop:t.prop,label:t.title[1]}}),a("el-table-column",{attrs:{label:t.title[2]}},[a("div",{staticClass:"hide"},[a("el-button",{attrs:{title:"播放",icon:"el-icon-caret-right",circle:""},on:{click:function(e){return t.play(e)}}}),a("el-button",{attrs:{title:"添加到歌单",icon:"el-icon-plus",circle:""}}),a("el-button",{attrs:{title:"下载",icon:"el-icon-download",circle:""}}),a("el-button",{attrs:{title:"分享",icon:"el-icon-share",circle:""}})],1)])],1),t.total>10?a("el-pagination",{staticClass:"detail-pagination",attrs:{background:"",layout:"prev, pager, next","pager-count":5,"page-size":10,total:t.total,"current-page":t.curPage},on:{"update:currentPage":function(e){t.curPage=e},"update:current-page":function(e){t.curPage=e}}}):t._e()],1)},Vt=[],Ut={name:"Table",data:function(){return{curPage:1,list:null}},props:["curList","playlist","total","title","prop","width"],created:function(){this.list=this.curList},methods:{indexMethod:function(t){return 10*(this.curPage-1)+t+1},showBtnGroup:function(t,e,a,n){a.parentNode.children[3].children[0].children[0].classList.remove("hide")},hideBtnGroup:function(t,e,a,n){a.parentNode.children[3].children[0].children[0].classList.add("hide")},play:function(t){var e=t.currentTarget.parentNode.parentNode.parentNode,a=e.parentNode,n=a.children[0].children[0].children[0].innerHTML;"歌手"===this.title[1]?this.playSong(n):this.playPlaylist(n)},playSong:function(t){var e;e=this.playlist.tracks?this.playlist.tracks[t-1].sid:this.playlist.results[t-1].sid;var a=window.localStorage.getItem("hasPlayerPage");if(a){this.$message("所选歌曲已经加入播放器");var n=JSON.parse(window.localStorage.getItem("playlist"))||[];n.unshift(e),window.localStorage.setItem("playlist",JSON.stringify(n))}else{window.localStorage.setItem("hasPlayerPage",!0);var s=this.$router.resolve({name:"player",query:{sid:e}});window.open(s.href,"_blank")}},playPlaylist:function(t){var e=this.playlist.results[t-1].tracks,a=window.localStorage.getItem("hasPlayerPage");if(a)window.localStorage.setItem("playlist",JSON.stringify(e));else{window.localStorage.setItem("hasPlayerPage",!0);var n=e.shift();window.localStorage.setItem("playlist",JSON.stringify(e));var s=this.$router.resolve({name:"player",query:{sid:n}});window.open(s.href,"_blank")}}},watch:{curPage:function(t,e){this.playlist.tracks?this.list=this.playlist.tracks.slice(10*(t-1),10*t):this.list=this.playlist.results.slice(10*(t-1),10*t)}}},zt=Ut,At=(a("a333"),Object(l["a"])(zt,Bt,Vt,!1,null,"5291c242",null)),Kt=At.exports,Qt={name:"Detail",data:function(){return{playlist:null,total:null,curPage:1,curList:null,commentNum:null}},created:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading"});setTimeout((function(){e.close()}),400);var a=this.$route.query.lid;nt(a).then((function(e){console.log("歌单信息",e),t.playlist=e,t.total=e.tracks.length,t.curList=t.playlist.tracks.slice(10*(t.curPage-1),10*t.curPage),kt(e.lid,1,5).then((function(e){t.commentNum=e.data.totalElements}))}))},components:{Comment:qt,Breadcrumb:Gt,Table:Kt},methods:{playAll:function(){var t=[];this.playlist.tracks.forEach((function(e){t.push(e.sid)}));var e=window.localStorage.getItem("hasPlayerPage");if(e)window.localStorage.setItem("playlist",JSON.stringify(t));else{window.localStorage.setItem("hasPlayerPage",!0);var a=t.shift();window.localStorage.setItem("playlist",JSON.stringify(t));var n=this.$router.resolve({name:"player",query:{sid:a}});window.open(n.href,"_blank")}},goToComment:function(){var t=document.querySelector("#comment");document.documentElement.scrollTop=t.offsetTop}}},Wt=Qt,Xt=(a("17ee"),Object(l["a"])(Wt,Ct,wt,!1,null,"2852cd88",null)),Yt=Xt.exports,Zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("header",{staticClass:"banner"},[a("el-input",{staticClass:"input",attrs:{placeholder:"搜索音乐、歌单、用户"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}},[a("i",{staticClass:"el-icon-search",attrs:{slot:"suffix"},on:{click:t.search},slot:"suffix"})])],1),a("main",[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"单曲",name:"first"}},[a("Tab",{attrs:{label:"单曲",text:t.text}})],1),a("el-tab-pane",{attrs:{label:"歌单",name:"second"}},[a("Tab",{attrs:{label:"歌单",text:t.text}})],1),a("el-tab-pane",{attrs:{label:"用户",name:"third"}},[a("Tab",{attrs:{label:"用户",text:t.text}})],1)],1)],1)])},te=[],ee=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.curList?a("Table",{attrs:{curList:t.curList,playlist:t.playlist,total:t.total,title:t.title,prop:t.prop,width:400}}):t._e()],1)},ae=[],ne=(O("java"),O("python")),se=function(t){return k({url:"".concat(ne,"/song/?search=").concat(t,"&ps=300"),method:"get"})},oe=function(t){return k({url:"".concat(ne,"/playlist/?search=").concat(t,"&ps=300"),method:"get"})},re={name:"Tab",data:function(){return{curList:null,playlist:null,total:null,title:null,prop:null}},components:{Table:Kt},props:["label","text"],created:function(){this.judgeSearchType(this.label)},methods:{judgeSearchType:function(t){var e=this;switch(t){case"单曲":se(this.text).then((function(t){e.playlist=t,e.total=t.count,e.curList=e.playlist.results.slice(0,10),e.title=["歌曲","歌手","操作"],e.prop="authors[0].name"}));break;case"歌单":oe(this.text).then((function(t){e.playlist=t,e.total=t.count,e.curList=e.playlist.results.slice(0,10),e.title=["歌单","创建者","操作"],e.prop="creator"}));break;case"用户":break}}}},ie=re,le=Object(l["a"])(ie,ee,ae,!1,null,"6112aea8",null),ce=le.exports,ue={name:"Search",data:function(){return{searchText:null,activeName:"first"}},components:{Tab:ce},computed:{text:function(){return this.$route.query.searchText}},watch:{text:function(t){window.location.reload(),this.searchText=t}},methods:{search:function(){var t=this.searchText;null!=t&&(this.searchText=null,this.$router.push({name:"search",query:{searchText:t}}))}}},me=ue,de=(a("7e6a"),Object(l["a"])(me,Zt,te,!1,null,"53eb171f",null)),pe=de.exports;n["default"].use(m["a"]);var fe=[{path:"/",redirect:"/home"},{path:"/",name:"home",component:Y,children:[{path:"home",name:"main",component:xt},{path:"home/detail",name:"detail",component:Yt},{path:"search",name:"search",component:pe}]},{path:"/player",name:"player",component:lt}],he=m["a"].prototype.push;m["a"].prototype.push=function(t){return he.call(this,t)["catch"]((function(t){return t}))};var ge=new m["a"]({mode:"hash",routes:fe}),ve=ge,ye=a("2f62");function be(t){window.localStorage.setItem("state",JSON.stringify(t))}n["default"].use(ye["a"]);var _e=new ye["a"].Store({state:{userInfo:null},mutations:{LOGINED:function(t,e){t.userInfo=e,be(t)},LOGOUT:function(t){t.userInfo=null,be(t)}},actions:{logined:function(t,e){var a=t.commit;a("LOGINED",e)},logout:function(t){var e=t.commit;e("LOGOUT")}},modules:{}}),xe=a("5c96"),Ce=a.n(xe);n["default"].use(Ce.a),n["default"].config.productionTip=!1,new n["default"]({router:ve,store:_e,render:function(t){return t(u)}}).$mount("#app")},6562:function(t,e,a){},"7c55":function(t,e,a){"use strict";var n=a("2395"),s=a.n(n);s.a},"7e6a":function(t,e,a){"use strict";var n=a("dae9"),s=a.n(n);s.a},"7eec":function(t,e,a){"use strict";var n=a("a060"),s=a.n(n);s.a},8009:function(t,e,a){},"8ab8":function(t,e,a){},"8af5":function(t,e,a){},"8d91":function(t,e,a){},"9f87":function(t,e,a){},a060:function(t,e,a){},a333:function(t,e,a){"use strict";var n=a("4319"),s=a.n(n);s.a},ab61:function(t,e,a){"use strict";var n=a("8009"),s=a.n(n);s.a},aff6:function(t,e,a){"use strict";var n=a("9f87"),s=a.n(n);s.a},c453:function(t,e,a){"use strict";var n=a("6562"),s=a.n(n);s.a},dae9:function(t,e,a){},de16:function(t,e,a){"use strict";var n=a("8d91"),s=a.n(n);s.a},e394:function(t,e,a){"use strict";var n=a("fa38"),s=a.n(n);s.a},e7e4:function(t,e,a){},eabe:function(t,e,a){"use strict";var n=a("8ab8"),s=a.n(n);s.a},f5df:function(t,e,a){},f81a:function(t,e,a){"use strict";var n=a("e7e4"),s=a.n(n);s.a},fa38:function(t,e,a){}});
//# sourceMappingURL=app.ab3ac075.js.map